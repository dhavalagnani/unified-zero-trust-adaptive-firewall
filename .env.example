# .env.example
#
# Purpose: Example environment configuration for Unified Zero-Trust Adaptive Firewall
# Context: Copy this file to .env and customize for your deployment
# 
# Usage: cp .env.example .env
# Then edit .env with your specific configuration values

# ============================================================================
# KEYCLOAK CONFIGURATION
# Context: OpenID Connect provider for authentication and authorization
# ============================================================================
KEYCLOAK_URL=http://localhost:8080
KEYCLOAK_REALM=uztaf
KEYCLOAK_CLIENT_ID=pep-client
KEYCLOAK_CLIENT_SECRET=your-client-secret-here

# ============================================================================
# PEP (Policy Enforcement Point) CONFIGURATION
# Context: FastAPI reverse proxy that enforces authentication and authorization
# ============================================================================
PEP_HOST=0.0.0.0
PEP_PORT=8000
PEP_WORKERS=4
PEP_LOG_LEVEL=INFO

# Backend service to proxy to
BACKEND_SERVICE_URL=http://localhost:8080

# JWT validation settings
JWT_ALGORITHM=RS256
JWT_PUBLIC_KEY_URL=${KEYCLOAK_URL}/realms/${KEYCLOAK_REALM}/protocol/openid-connect/certs

# ============================================================================
# CORRELATION ENGINE CONFIGURATION
# Context: Real-time event correlation and dynamic rule generation
# ============================================================================
CORRELATION_HOST=0.0.0.0
CORRELATION_PORT=5000
CORRELATION_LOG_LEVEL=INFO

# Database configuration
CORRELATION_DB_PATH=/var/lib/uztaf/correlation.db

# Event source configurations
ZEEK_LOG_PATH=/var/log/zeek
SURICATA_LOG_PATH=/var/log/suricata/eve.json

# Rule generation thresholds
CORRELATION_THRESHOLD=3
CORRELATION_WINDOW_SECONDS=300
ANOMALY_SCORE_THRESHOLD=0.75

# ============================================================================
# AGENT CONFIGURATION
# Context: Client-side enforcement agent that manages nftables rules
# ============================================================================
AGENT_LOG_LEVEL=INFO
AGENT_HEARTBEAT_INTERVAL=30

# WebSocket connection to correlation engine
CORRELATION_WS_URL=ws://correlation-server:5000/ws

# nftables configuration
NFTABLES_TABLE=filter
NFTABLES_CHAIN=uztaf_quarantine

# ============================================================================
# NETWORK CONFIGURATION
# Context: Network-related settings for the UZTAF system
# ============================================================================
# VLAN for quarantined devices
QUARANTINE_VLAN=999

# Network monitoring interfaces
MONITORING_INTERFACE=eth0

# ============================================================================
# TLS/SSL CERTIFICATE PATHS
# Context: Paths to certificates for secure communication
# ============================================================================
TLS_CERT_PATH=/etc/uztaf/certs/server.crt
TLS_KEY_PATH=/etc/uztaf/certs/server.key
TLS_CA_PATH=/etc/uztaf/certs/ca.crt

# ============================================================================
# REDIS CONFIGURATION (Optional)
# Context: For distributed caching and pub/sub between components
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# ============================================================================
# LOGGING CONFIGURATION
# Context: Centralized logging settings
# ============================================================================
LOG_FORMAT=json
LOG_OUTPUT=/var/log/uztaf
SYSLOG_HOST=localhost
SYSLOG_PORT=514

# ============================================================================
# ANSIBLE CONFIGURATION
# Context: Infrastructure deployment settings
# ============================================================================
ANSIBLE_INVENTORY=infra/ansible/hosts.ini
ANSIBLE_VAULT_PASSWORD=

# ============================================================================
# SWITCH INTEGRATION (Optional)
# Context: For RADIUS CoA (Change of Authorization) to network switches
# ============================================================================
SWITCH_TYPE=cisco  # cisco, aruba, generic
SWITCH_MANAGEMENT_IP=192.168.1.1
SWITCH_RADIUS_SECRET=shared-secret
SWITCH_API_USERNAME=admin
SWITCH_API_PASSWORD=

# ============================================================================
# TESTING CONFIGURATION
# Context: Settings for integration and unit tests
# ============================================================================
TEST_MODE=false
TEST_DB_PATH=/tmp/uztaf_test.db
MOCK_KEYCLOAK=false

# ============================================================================
# FEATURE FLAGS
# Context: Enable/disable specific features
# ============================================================================
ENABLE_MACHINE_LEARNING=true
ENABLE_THREAT_INTELLIGENCE=false
ENABLE_AUTO_REMEDIATION=true
ENABLE_METRICS_EXPORT=true

# ============================================================================
# PROMETHEUS/METRICS CONFIGURATION (Optional)
# Context: For monitoring and observability
# ============================================================================
METRICS_PORT=9090
METRICS_PATH=/metrics
PROMETHEUS_URL=http://localhost:9090
