# infra/ansible/hosts.ini
#
# Purpose: Ansible inventory file defining all hosts in the UZTAF infrastructure
# Context: Defines the infrastructure topology with groups for different components:
#          - pep_servers: Policy Enforcement Points (reverse proxies)
#          - correlation_servers: Correlation engine instances
#          - agent_nodes: Endpoints running enforcement agents
#          - keycloak_servers: Identity and access management
#          - monitoring: Zeek, Suricata, and monitoring infrastructure
#
# Usage: ansible-playbook -i infra/ansible/hosts.ini infra/ansible/site.yml

# ============================================================================
# PEP (Policy Enforcement Point) Servers
# Context: FastAPI reverse proxies that enforce authentication/authorization
# ============================================================================
[pep_servers]
pep1.example.com ansible_host=10.0.1.10 ansible_user=ubuntu
pep2.example.com ansible_host=10.0.1.11 ansible_user=ubuntu

# ============================================================================
# Correlation Engine Servers
# Context: Servers running the event correlation and rule generation engine
# ============================================================================
[correlation_servers]
correlation1.example.com ansible_host=10.0.2.10 ansible_user=ubuntu
# Add more correlation servers for high availability
# correlation2.example.com ansible_host=10.0.2.11 ansible_user=ubuntu

# ============================================================================
# Agent Nodes
# Context: Endpoints running the enforcement agent (nftables management)
# ============================================================================
[agent_nodes]
# Infrastructure nodes
gateway1.example.com ansible_host=10.0.3.10 ansible_user=ubuntu
gateway2.example.com ansible_host=10.0.3.11 ansible_user=ubuntu

# Application servers
app-server1.example.com ansible_host=10.0.4.10 ansible_user=ubuntu
app-server2.example.com ansible_host=10.0.4.11 ansible_user=ubuntu

# Database servers
db-server1.example.com ansible_host=10.0.5.10 ansible_user=ubuntu

# ============================================================================
# Keycloak Identity Servers
# Context: OpenID Connect provider for authentication
# ============================================================================
[keycloak_servers]
keycloak1.example.com ansible_host=10.0.6.10 ansible_user=ubuntu
# For HA setup, add more Keycloak servers
# keycloak2.example.com ansible_host=10.0.6.11 ansible_user=ubuntu

# ============================================================================
# Network Monitoring Infrastructure
# Context: Zeek and Suricata instances for traffic analysis
# ============================================================================
[monitoring_servers]
zeek1.example.com ansible_host=10.0.7.10 ansible_user=ubuntu
suricata1.example.com ansible_host=10.0.7.11 ansible_user=ubuntu

# ============================================================================
# Management and Bastion Hosts
# Context: Administrative access points
# ============================================================================
[bastion]
bastion.example.com ansible_host=10.0.0.10 ansible_user=ubuntu

# ============================================================================
# Group Variables and Parent Groups
# ============================================================================

# All UZTAF core components
[uztaf_core:children]
pep_servers
correlation_servers
agent_nodes
keycloak_servers

# All monitoring infrastructure
[monitoring:children]
monitoring_servers

# All servers (for global tasks)
[all_servers:children]
uztaf_core
monitoring
bastion

# ============================================================================
# Group Variables (can also be defined in group_vars/)
# ============================================================================

[pep_servers:vars]
pep_port=8000
pep_workers=4
backend_service_url=http://localhost:8080

[correlation_servers:vars]
correlation_port=5000
correlation_db_path=/var/lib/uztaf/correlation.db

[agent_nodes:vars]
nftables_table=filter
nftables_chain=uztaf_quarantine

[keycloak_servers:vars]
keycloak_port=8080
keycloak_realm=uztaf

[monitoring_servers:vars]
zeek_log_path=/var/log/zeek
suricata_log_path=/var/log/suricata

# Global variables for all hosts
[all_servers:vars]
ansible_python_interpreter=/usr/bin/python3
ansible_ssh_common_args='-o StrictHostKeyChecking=no'
log_level=INFO
